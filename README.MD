# PetExpress Backend

A Spring Boot 3 project built with Java 21 for the final college assignment at Unimar. It provides the REST API used by the PetExpress management system.

## ðŸ‡ºðŸ‡¸ English

### [Deploy](https://petexpress-back.onrender.com)
This API is currently running at: <https://petexpress-back.onrender.com>.
The PostgreSQL database is hosted on [Neon](https://neon.tech/).

### Requirements
- Java 21 and Maven 3.9+
- PostgreSQL database
- Docker (optional)

### Setup
1. Clone the repository:
   ```bash
   git clone <https://github.com/IsraelDev560/petexpress-back/tree/main>
   cd petexpress-back
   ```
2. Create an `.env.local` file in the project root with your database credentials and JWT secret:
   ```env
   DATABASE_URL=jdbc:postgresql://localhost:5432/petexpress
   DATABASE_USER=postgres
   DATABASE_PASSWORD=postgres
   JWT_SECRET=your-secret
   ```
3. Run the application:
   ```bash
   ./mvnw spring-boot:run
   ```
   The API will be available on `http://localhost:8080`.
4. You can also build a container and start it using Docker Compose (requires the variables above):
   ```bash
   docker compose up --build
   ```
5. If you want to run a local PostgreSQL instance together with the API, use `docker-compose-local.yml`:
   ```bash
   docker compose -f docker-compose-local.yml up --build
   ```

### Folder structure
- `controller/` â€“ REST controllers for authentication, animals, tasks, task types and users.
- `entities/` â€“ JPA entities such as `User`, `Animal`, `Task` and `TaskType`.
- `dto/` â€“ Request and response DTOs.
- `service/` â€“ Business services and token generation.
- `repository/` â€“ Spring Data repositories.
- `security/` â€“ JWT authentication filter and security configuration.
- `exceptions/` â€“ Custom exceptions and global handler.

### API Endpoints
Most routes require a valid Bearer token obtained from `POST /auth/login`.

- `POST /auth/login` â€“ authenticate and receive a JWT.
- `POST /auth/register` â€“ create a new user (ADMIN role required).
- `GET /animals`, `GET /animals/{id}`, `POST /animals`, `PATCH /animals/{id}`, `DELETE /animals/{id}`
- `GET /task`, `POST /task`, `GET /task/{id}`, `PUT /task/{id}`, `DELETE /task/{id}`
- `GET /task-types`, `POST /task-types`, `GET /task-types/{id}`, `PUT /task-types/{id}`, `DELETE /task-types/{id}`
- `GET /users`, `GET /users/{id}`, `GET /users/myinfo`, `PATCH /users/{id}`, `DELETE /users/{id}`

Swagger documentation is available at `/swagger-ui/index.html`.

---

## ðŸ‡§ðŸ‡· PortuguÃªs

### [Deploy](https://petexpress-back.onrender.com)
Esta API estÃ¡ hospedada em: <https://petexpress-back.onrender.com>.
O banco de dados PostgreSQL fica no [Neon](https://neon.tech/).

### Requisitos
- Java 21 e Maven 3.9+
- Servidor PostgreSQL
- Docker (opcional)

### ConfiguraÃ§Ã£o
1. Clone o repositÃ³rio:
   ```bash
   git clone <https://github.com/IsraelDev560/petexpress-back/tree/main>
   cd petexpress-back
   ```
2. Crie um arquivo `.env.local` na raiz com as variÃ¡veis de ambiente:
   ```env
   DATABASE_URL=jdbc:postgresql://localhost:5432/petexpress
   DATABASE_USER=postgres
   DATABASE_PASSWORD=postgres
   JWT_SECRET=sua-chave
   ```
3. Inicie a aplicaÃ§Ã£o:
   ```bash
   ./mvnw spring-boot:run
   ```
   A API ficarÃ¡ acessÃ­vel em `http://localhost:8080`.
4. Caso prefira, use Docker Compose para gerar a imagem e executar (Ã© preciso definir as variÃ¡veis acima):
   ```bash
   docker compose up --build
   ```
5. Para rodar um PostgreSQL local junto com a API, utilize `docker-compose-local.yml`:
   ```bash
   docker compose -f docker-compose-local.yml up --build
   ``

### Estrutura de pastas
- `controller/` â€“ controladores REST para autenticaÃ§Ã£o, animais, tarefas, tipos de tarefa e usuÃ¡rios.
- `entities/` â€“ entidades JPA como `User`, `Animal`, `Task` e `TaskType`.
- `dto/` â€“ DTOs de requisiÃ§Ã£o e resposta.
- `service/` â€“ regras de negÃ³cio e geraÃ§Ã£o de token.
- `repository/` â€“ repositÃ³rios Spring Data.
- `security/` â€“ filtro JWT e configuraÃ§Ã£o de seguranÃ§a.
- `exceptions/` â€“ exceÃ§Ãµes customizadas e tratador global.

### Rotas da API
A maioria das rotas requer um token Bearer obtido em `POST /auth/login`.

- `POST /auth/login` â€“ gera um JWT.
- `POST /auth/register` â€“ cria um novo usuÃ¡rio (requer papel ADMIN).
- `GET /animals`, `GET /animals/{id}`, `POST /animals`, `PATCH /animals/{id}`, `DELETE /animals/{id}`
- `GET /task`, `POST /task`, `GET /task/{id}`, `PUT /task/{id}`, `DELETE /task/{id}`
- `GET /task-types`, `POST /task-types`, `GET /task-types/{id}`, `PUT /task-types/{id}`, `DELETE /task-types/{id}`
- `GET /users`, `GET /users/{id}`, `GET /users/myinfo`, `PATCH /users/{id}`, `DELETE /users/{id}`

A documentaÃ§Ã£o Swagger fica disponÃ­vel em `/swagger-ui/index.html`.